(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{375:function(t,_,e){t.exports=e.p+"assets/img/channel_twilio.bfa2cd63.png"},376:function(t,_,e){t.exports=e.p+"assets/img/notification_target_twilio.e27b6341.png"},377:function(t,_,e){t.exports=e.p+"assets/img/alert.708b1cef.png"},392:function(t,_,e){"use strict";e.r(_);var v=e(45),r=Object(v.a)({},(function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"twilioと連携して架電通知をする"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#twilioと連携して架電通知をする"}},[t._v("#")]),t._v(" Twilioと連携して架電通知をする")]),t._v(" "),v("p",[t._v("Twilioハンズオンで作成したアカウントを利用して、アラート通知をメール通知ではなく電話による架電通知する設定を行ってみましょう。")]),t._v(" "),v("h2",{attrs:{id:"twilioの通知チャンネルを作成する"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#twilioの通知チャンネルを作成する"}},[t._v("#")]),t._v(" Twilioの通知チャンネルを作成する")]),t._v(" "),v("p",[t._v("左サイドメニューから"),v("a",{attrs:{href:"https://mackerel.io/my/channels",target:"_blank",rel:"noopener noreferrer"}},[t._v("Channels"),v("OutboundLink")],1),t._v("を開いて、右上にある"),v("code",[t._v("通知グループ／通知チャンネルを追加")]),t._v("からTwilioの通知チャンネルを追加します。")]),t._v(" "),v("p",[v("img",{attrs:{src:e(375),alt:""}})]),t._v(" "),v("p",[t._v("Twilioのハンズオンで作成したアカウントで払い出された"),v("code",[t._v("ACCOUNT SID")]),t._v("と"),v("code",[t._v("AUTH TOKEN")]),t._v("、"),v("code",[t._v("電話番号")]),t._v("などを入力して保存してください。")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("項目")]),t._v(" "),v("th",[t._v("設定値")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("通知チャンネル名")]),t._v(" "),v("td",[v("code",[t._v("架電通知")]),t._v("（任意）")])]),t._v(" "),v("tr",[v("td",[t._v("AccountSid")]),t._v(" "),v("td",[v("a",{attrs:{href:"https://www.twilio.com/console",target:"_blank",rel:"noopener noreferrer"}},[t._v("Twilioのコンソール"),v("OutboundLink")],1),t._v("から"),v("code",[t._v("ACCOUNT SID")]),t._v("を転記")])]),t._v(" "),v("tr",[v("td",[t._v("AuthToken")]),t._v(" "),v("td",[v("a",{attrs:{href:"https://www.twilio.com/console",target:"_blank",rel:"noopener noreferrer"}},[t._v("Twilioのコンソール"),v("OutboundLink")],1),t._v("から"),v("code",[t._v("AUTH TOKEN")]),t._v("を転記")])]),t._v(" "),v("tr",[v("td",[t._v("From")]),t._v(" "),v("td",[v("a",{attrs:{href:"https://www.twilio.com/console/phone-numbers/incoming",target:"_blank",rel:"noopener noreferrer"}},[t._v("Twilioのコンソール"),v("OutboundLink")],1),t._v("から確保した電話番号を転記")])]),t._v(" "),v("tr",[v("td",[t._v("To")]),t._v(" "),v("td",[t._v("着信可能な電話番号を入力（電話番号の前に"),v("code",[t._v("+81")]),t._v("を付加してください）")])]),t._v(" "),v("tr",[v("td",[t._v("Notification Type")]),t._v(" "),v("td")]),t._v(" "),v("tr",[v("td",[t._v("Message")]),t._v(" "),v("td",[v("code",[t._v("アラートを確認してください")]),t._v("（発話させる内容を入力）")])]),t._v(" "),v("tr",[v("td",[t._v("Language")]),t._v(" "),v("td",[v("code",[t._v("ja-JP")])])]),t._v(" "),v("tr",[v("td",[t._v("Notification Level")]),t._v(" "),v("td",[v("code",[t._v("Warning & Critical")])])]),t._v(" "),v("tr",[v("td",[t._v("Status Callback URL(Optional)")]),t._v(" "),v("td",[t._v("（未設定）")])]),t._v(" "),v("tr",[v("td",[t._v("通知するイベント")]),t._v(" "),v("td",[t._v("（変更しない）")])]),t._v(" "),v("tr",[v("td",[t._v("デフォルト通知グループに追加する")]),t._v(" "),v("td",[t._v("チェックを外す")])])])]),t._v(" "),v("p",[t._v("通知チャンネルにTwilioのチャンネルが追加されていることを確認してみましょう。")]),t._v(" "),v("h2",{attrs:{id:"通知グループに紐付ける"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#通知グループに紐付ける"}},[t._v("#")]),t._v(" 通知グループに紐付ける")]),t._v(" "),v("p",[t._v("次にハンズオンで作成した通知グループ（手順通りだと"),v("code",[t._v("HTTPプロセスの監視")]),t._v("のグループ）の通知先のチャンネルを"),v("code",[t._v("Email Broadcast")]),t._v("から追加したTwilioのチャンネルに変更します。")]),t._v(" "),v("p",[v("img",{attrs:{src:e(376),alt:""}})]),t._v(" "),v("p",[t._v("わかりやすくするために"),v("code",[t._v("Email Broadcast")]),t._v("のチャンネルはオフにしておきましょう。")]),t._v(" "),v("h2",{attrs:{id:"障害を起こして通知の確認をする"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#障害を起こして通知の確認をする"}},[t._v("#")]),t._v(" 障害を起こして通知の確認をする")]),t._v(" "),v("p",[t._v("それでは障害を起こして通知を確認してみましょう。")]),t._v(" "),v("p",[t._v("前回と同様にサーバー上でhttpdプロセスを停止してアラートが発報されることを確認しましょう。")]),t._v(" "),v("div",{staticClass:"language-shell extra-class"},[v("pre",{pre:!0,attrs:{class:"language-shell"}},[v("code",[v("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl stop httpd\n")])])]),v("p",[t._v("指定した電話番号宛に架電され、指定したメッセージによる通知が行われたでしょうか？")]),t._v(" "),v("p",[v("a",{attrs:{href:"https://mackerel.io/my/alerts",target:"_blank",rel:"noopener noreferrer"}},[t._v("Alerts"),v("OutboundLink")],1),t._v("を確認すると、通知先が作成したTwilioのチャンネルにのみ通知されていることが確認できるかと思います。")]),t._v(" "),v("p",[v("img",{attrs:{src:e(377),alt:""}})]),t._v(" "),v("p",[t._v("Twilioとの連携はいかがでしたでしょうか？とても簡単に連携ができることを体験いただけたかと思います！")]),t._v(" "),v("p",[t._v("ぜひ、本番環境などを監視される際はTwilioとの連携も併せてお試しください！")])])}),[],!1,null,null,null);_.default=r.exports}}]);