(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{366:function(t,_,a){t.exports=a.p+"assets/img/channels.cefa6c8e.png"},367:function(t,_,a){t.exports=a.p+"assets/img/notification_group.dc331182.png"},368:function(t,_,a){t.exports=a.p+"assets/img/notification_target.a676d485.png"},407:function(t,_,a){"use strict";a.r(_);var v=a(45),e=Object(v.a)({},(function(){var t=this,_=t.$createElement,v=t._self._c||_;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"通知をカスタマイズする"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#通知をカスタマイズする"}},[t._v("#")]),t._v(" 通知をカスタマイズする")]),t._v(" "),v("p",[t._v("Mackerelでは障害の発生を検知するとアラートが発報され、デフォルトではオーガニゼーションに所属しているメンバーのメールアドレスに対してアラート通知を行う設定がされています。")]),t._v(" "),v("h2",{attrs:{id:"チャンネル設定を確認する"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#チャンネル設定を確認する"}},[t._v("#")]),t._v(" チャンネル設定を確認する")]),t._v(" "),v("p",[t._v("左サイドメニューから"),v("a",{attrs:{href:"https://mackerel.io/my/channels",target:"_blank",rel:"noopener noreferrer"}},[t._v("Channels"),v("OutboundLink")],1),t._v("を開いて確認してみましょう。")]),t._v(" "),v("p",[v("img",{attrs:{src:a(366),alt:""}})]),t._v(" "),v("p",[t._v("初期状態では"),v("code",[t._v("Default")]),t._v("の通知グループと"),v("code",[t._v("Email Broadcast")]),t._v("の通知チャンネルが登録されています。")]),t._v(" "),v("p",[t._v("通知チャンネルでは通知方法と通知するイベントを、通知グループでは通知対象とするサービスや監視ルールとそれらの通知先となる通知チャンネルを指定することで、監視ルールごとに通知先を振り分けるなどのコントロールができます。")]),t._v(" "),v("p",[v("code",[t._v("Default")]),t._v("の通知グループではオーガニゼーションの全てのサービスの通知を"),v("code",[t._v("Email Broadcast")]),t._v("のチャンネルに通知するように設定されていることがわかるかと思います。")]),t._v(" "),v("h2",{attrs:{id:"通知グループを追加する"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#通知グループを追加する"}},[t._v("#")]),t._v(" 通知グループを追加する")]),t._v(" "),v("p",[t._v("このハンズオンでは通知グループを新しく追加して、任意の監視ルールの通知を作成した通知グループにだけ通知されるような設定をしてみましょう。")]),t._v(" "),v("p",[t._v("まずは"),v("a",{attrs:{href:"https://mackerel.io/my/channels",target:"_blank",rel:"noopener noreferrer"}},[t._v("Channels"),v("OutboundLink")],1),t._v("の右上にある"),v("code",[t._v("通知グループ／通知チャンネルを追加")]),t._v("から通知グループを追加します。")]),t._v(" "),v("p",[v("img",{attrs:{src:a(367),alt:""}})]),t._v(" "),v("p",[t._v("1つ前のハンズオンで設定したhttpdプロセスの監視に関するアラートのみ通知する通知グループとして以下のように設定します。")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("項目")]),t._v(" "),v("th",[t._v("設定値")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("通知グループ名")]),t._v(" "),v("td",[v("code",[t._v("HTTPプロセスの監視")]),t._v("（任意）")])]),t._v(" "),v("tr",[v("td",[t._v("サービス（通知対象）")]),t._v(" "),v("td",[t._v("未設定")])]),t._v(" "),v("tr",[v("td",[t._v("監視ルール（通知対象）")]),t._v(" "),v("td",[v("code",[t._v("proc_httpd")]),t._v("を指定")])]),t._v(" "),v("tr",[v("td",[t._v("通知チャンネル（通知先）")]),t._v(" "),v("td",[v("code",[t._v("Email Broadcast")])])]),t._v(" "),v("tr",[v("td",[t._v("通知グループ（通知先）")]),t._v(" "),v("td",[t._v("未設定")])]),t._v(" "),v("tr",[v("td",[t._v("Critical Only（通知レベル）")]),t._v(" "),v("td",[t._v("変更しない")])]),t._v(" "),v("tr",[v("td",[t._v("デフォルト通知グループに追加する")]),t._v(" "),v("td",[t._v("チェックしない")])])])]),t._v(" "),v("p",[t._v("この様に設定すると特定の監視ルールのみ通知することができますが、"),v("code",[t._v("Default")]),t._v("通知グループでも"),v("code",[t._v("proc_httpd")]),t._v("の通知が行われるため二重で通知が行われてしまいます。")]),t._v(" "),v("p",[t._v("今回追加した通知グループにのみ"),v("code",[t._v("proc_httpd")]),t._v("の通知を行うには"),v("code",[t._v("この通知グループのみに通知する")]),t._v("にチェックをつけることで二重通知を抑止できます。")]),t._v(" "),v("p",[v("img",{attrs:{src:a(368),alt:""}})]),t._v(" "),v("p",[t._v("それではサーバー上でhttpdプロセスを停止してアラートが発報されることを確認しましょう。")]),t._v(" "),v("div",{staticClass:"language-shell extra-class"},[v("pre",{pre:!0,attrs:{class:"language-shell"}},[v("code",[v("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl stop httpd\n")])])]),v("p",[t._v("1分程度待つとアラートが発報して通知メールが1通届いたかと思います。")]),t._v(" "),v("p",[t._v("現時点では"),v("code",[t._v("Email Broadcast")]),t._v("の通知チャンネルしかないため通知グループによる通知の振り分けを感じられませんが、Twilioのハンズオンで作成したアカウントと連携した架電通知を後ほど試してみましょう！")]),t._v(" "),v("p",[t._v("Mackerelのハンズオンはここまでとなりますので、httpdプロセスを起動して障害を解消させます。")]),t._v(" "),v("div",{staticClass:"language-shell extra-class"},[v("pre",{pre:!0,attrs:{class:"language-shell"}},[v("code",[v("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start httpd\n")])])]),v("p",[t._v("お疲れさまでした！")])])}),[],!1,null,null,null);_.default=e.exports}}]);