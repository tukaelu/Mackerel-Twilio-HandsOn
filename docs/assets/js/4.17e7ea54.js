(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{366:function(t,r,e){t.exports=e.p+"assets/img/open_monitor.6c0dcd84.png"},367:function(t,r,e){t.exports=e.p+"assets/img/choose_host_metric_monitor.9424e4a9.png"},368:function(t,r,e){t.exports=e.p+"assets/img/add_host_metric_monitor.1c0f59ae.png"},386:function(t,r,e){"use strict";e.r(r);var _=e(45),v=Object(_.a)({},(function(){var t=this,r=t.$createElement,_=t._self._c||r;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"監視ルールを追加する"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#監視ルールを追加する"}},[t._v("#")]),t._v(" 監視ルールを追加する")]),t._v(" "),_("p",[t._v("このハンズオンでは監視ルールを設定して擬似的な障害を起こし、Mackerelでの障害対応を体験します。")]),t._v(" "),_("h2",{attrs:{id:"ホストのメトリックを監視する"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ホストのメトリックを監視する"}},[t._v("#")]),t._v(" ホストのメトリックを監視する")]),t._v(" "),_("p",[t._v("以下の手順に沿って、CPU使用率を監視するルールを設定してみましょう。")]),t._v(" "),_("p",[t._v("まずは左サイドメニュー"),_("a",{attrs:{href:"https://mackerel.io/my/monitors",target:"_blank",rel:"noopener noreferrer"}},[t._v("Monitors"),_("OutboundLink")],1),t._v("を開き、右上の"),_("code",[t._v("監視ルールを追加")]),t._v("をクリックします。\n"),_("img",{attrs:{src:e(366),alt:""}})]),t._v(" "),_("p",[_("code",[t._v("新規監視ルールを作成")]),t._v("のメニューの中から"),_("code",[t._v("ホストメトリック監視")]),t._v("を選択します。\n"),_("img",{attrs:{src:e(367),alt:""}})]),t._v(" "),_("br"),t._v(" "),_("p",[t._v("各項目に以下の表の内容を設定して監視ルールを作成しましょう。")]),t._v(" "),_("p",[_("img",{attrs:{src:e(368),alt:""}})]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("項目")]),t._v(" "),_("th",[t._v("設定値")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("メトリック")]),t._v(" "),_("td",[t._v("CPU %")])]),t._v(" "),_("tr",[_("td",[t._v("閾値（Warning条件）")]),t._v(" "),_("td",[t._v("70")])]),t._v(" "),_("tr",[_("td",[t._v("閾値（Critical条件）")]),t._v(" "),_("td",[t._v("90")])]),t._v(" "),_("tr",[_("td",[t._v("平均値監視")]),t._v(" "),_("td",[t._v("3点の平均値を監視")])]),t._v(" "),_("tr",[_("td",[t._v("最大試行回数")]),t._v(" "),_("td",[t._v("1回")])]),t._v(" "),_("tr",[_("td",[t._v("絞込条件")]),t._v(" "),_("td",[t._v("変更しない")])]),t._v(" "),_("tr",[_("td",[t._v("監視ルール名")]),t._v(" "),_("td",[t._v("任意")])]),t._v(" "),_("tr",[_("td",[t._v("監視ルールのメモ")]),t._v(" "),_("td",[t._v("任意")])]),t._v(" "),_("tr",[_("td",[t._v("通知の再送間隔")]),t._v(" "),_("td",[t._v("チェックしない")])])])]),t._v(" "),_("p",[_("a",{attrs:{href:"https://mackerel.io/my/monitors",target:"_blank",rel:"noopener noreferrer"}},[t._v("Monitors"),_("OutboundLink")],1),t._v("にホストメトリック監視のルールが追加されたことを確認します。")]),t._v(" "),_("h2",{attrs:{id:"監視対象サーバー上で障害を起こす"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#監視対象サーバー上で障害を起こす"}},[t._v("#")]),t._v(" 監視対象サーバー上で障害を起こす")]),t._v(" "),_("p",[t._v("続いて、監視対象サーバーにログインしたあとに、以下のコマンドを実行し意図的に CPU に負荷を掛けてみます。")]),t._v(" "),_("div",{staticClass:"language-shell extra-class"},[_("pre",{pre:!0,attrs:{class:"language-shell"}},[_("code",[_("span",{pre:!0,attrs:{class:"token function"}},[t._v("yes")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" /dev/null\n")])])]),_("ul",[_("li",[_("code",[t._v("yes")]),t._v("コマンドは標準出力に"),_("code",[t._v("y")]),t._v("を延々と出力し、その出力をただ捨てるだけのコマンドです。")])]),t._v(" "),_("p",[t._v("実行したら、少し時間をおいて変化を見てみましょう。")]),t._v(" "),_("h2",{attrs:{id:"webコンソールでアラートを確認する"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#webコンソールでアラートを確認する"}},[t._v("#")]),t._v(" Webコンソールでアラートを確認する")]),t._v(" "),_("ul",[_("li",[t._v("左サイドメニュー"),_("a",{attrs:{href:"https://mackerel.io/my/hosts",target:"_blank",rel:"noopener noreferrer"}},[t._v("Hosts"),_("OutboundLink")],1),t._v("から詳細画面を表示して、CPU使用率のグラフを確認しましょう。")]),t._v(" "),_("li",[t._v("アラートが発報されたら、左サイドメニュー"),_("a",{attrs:{href:"https://mackerel.io/my/alerts",target:"_blank",rel:"noopener noreferrer"}},[t._v("Alerts"),_("OutboundLink")],1),t._v("を確認してみましょう")])]),t._v(" "),_("p",[t._v("ここまでで、Mackerelではサーバーのグラフがどのように表示され、障害が発生した時の対応をどのように実施するかイメージいただけたでしょうか？")]),t._v(" "),_("p",[t._v("次のハンズオンでは公式プラグインを導入して、監視を拡張してみましょう。")])])}),[],!1,null,null,null);r.default=v.exports}}]);